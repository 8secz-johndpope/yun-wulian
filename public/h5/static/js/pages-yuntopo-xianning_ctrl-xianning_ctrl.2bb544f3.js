(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-yuntopo-xianning_ctrl-xianning_ctrl"],{"017c":function(t,e,a){var i=a("1ce1");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("03849f4e",i,!0,{sourceMap:!1,shadowMode:!1})},"1cae":function(t,e,a){"use strict";var i,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-image",{staticStyle:{width:"100%"},attrs:{mode:"aspectFit",src:t.topo_src}}),a("v-uni-view",{staticClass:"button-sp-area"},[a("v-uni-button",{staticClass:"mini-btn-right",attrs:{type:"primary",disabled:t.button_start_disable,size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.devstart.apply(void 0,arguments)}}},[t._v("启动")]),a("v-uni-button",{staticClass:"mini-btn-left",attrs:{type:"warn",disabled:t.button_stop_disable,size:"mini"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.devstop.apply(void 0,arguments)}}},[t._v("停止")])],1),a("ul",{staticClass:"box"},[a("li",{staticClass:"text"},[t._v("原水泵启停状态："+t._s(t.show_value[0]))]),a("li",{staticClass:"text"},[t._v("混合泵启停状态："+t._s(t.show_value[1]))]),a("li",{staticClass:"text"},[t._v("1#制氧机启停状态："+t._s(t.show_value[2]))]),a("li",{staticClass:"text"},[t._v("2#制氧机启停状态："+t._s(t.show_value[3]))]),a("li",{staticClass:"text"},[t._v("运行电流值："+t._s(t.show_value[4]))]),a("li",{staticClass:"text"},[t._v("进水流量值："+t._s(t.show_value[5]))])])],1)},o=[];a.d(e,"b",function(){return n}),a.d(e,"c",function(){return o}),a.d(e,"a",function(){return i})},"1ce1":function(t,e,a){e=t.exports=a("2350")(!1),e.push([t.i,"*[data-v-3dedaca1]{margin:0;padding:0}.button-sp-area[data-v-3dedaca1]{margin:0 auto;width:60%}.mini-btn-right[data-v-3dedaca1]{margin-right:%?10?%}.mini-btn-left[data-v-3dedaca1]{margin-left:auto;float:right}.label-2-text[data-v-3dedaca1]{text-align:center;width:100%}.swiper-item[data-v-3dedaca1]{height:%?30?%;width:40%;text-align:center;display:-webkit-box;display:-webkit-flex;display:flex}.grid-item[data-v-3dedaca1]{display:block;height:%?40?%;width:40%;text-align:center;display:-webkit-box;display:-webkit-flex;display:flex}.right[data-v-3dedaca1]{position:absolute; /*右栏定位过去*/top:0;right:0;background-color:#fcc;width:100px;height:100px\n    /*opacity:0.5; /*半透明*/}.mid[data-v-3dedaca1]{position:absolute;/*定位到右栏左边正好相邻的地方*/top:0;right:100px;background:#6495ed;width:100px;height:100px}.left[data-v-3dedaca1]{background-color:#ff0;height:100px;\n    /*不设置宽，默认占整行*/margin-right:200px\n    /*设置右边框，使其刚好让出中栏和右栏的位置*/}li[data-v-3dedaca1],ul[data-v-3dedaca1]{list-style:none;margin:0;padding:0;width:100%}.box[data-v-3dedaca1]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.box li[data-v-3dedaca1]{width:calc(50% - 5px);height:30px;background:#ffe4e1;margin:5px 0}",""])},"1e42":function(t,e,a){"use strict";var i=a("017c"),n=a.n(i);n.a},"5ef2":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("c78e"),n={data:function(){return{button_start_disable:!1,button_stop_disable:!1,run_status_string:"停止",gateway_sn:"",devunit_name:"",devunit_id:1e4,real_data_list:[],show_value:[0,0,0,0,0,0,0,0,0,0],topo_src:"../../../static/wushui.png",topo_src_start:"../../../static/wushui-start.png",topo_src_stop:"../../../static/wushui-stop.png"}},onLoad:function(t){console.log("[xianning_ctrl] onLoad...., option:",t),this.gateway_sn=t["gateway_sn"],this.devunit_name=t["devunit_name"],this.devunit_id=t["devunit_id"],this.getDeviceRealData(this.devunit_name)},methods:{getDeviceRealData:function(t){var e=this;i.post({url:"gateway/real/data",data:{filter:{devunit_name:t}},success:function(t){if(console.log("[xianning_ctrl] gateway/real/data",t),0==t.ret_code){e.loading=!1,e.real_data_list=t.extra,e.devunit_id=e.real_data_list["devunit_id"];for(var a=e.real_data_list["data"],i=0;i<a.length;i++)"原水泵启停"==a[i].varName&&"1"==a[i].varValue?e.show_value[0]="运行":e.show_value[0]="停止","混合泵启停"==a[i].varName&&"1"==a[i].varValue?e.show_value[1]="运行":e.show_value[1]="停止","制氧-臭氧启停1"==a[i].varName&&"1"==a[i].varValue?e.show_value[2]="运行":e.show_value[2]="停止","制氧-臭氧启停2"==a[i].varName&&"1"==a[i].varValue?e.show_value[3]="运行":e.show_value[3]="停止","运行电流值"==a[i].varName&&(e.show_value[4]=a[i].varValue+" MA"),"进水流量值"==a[i].varName&&(e.show_value[5]=a[i].varValue+" M3/h")}0!=t.ret_code&&(e.loading=!1,uni.showToast({duration:1500,icon:"none",title:t.ret_msg}))}})},remote_wirte_value:function(t,e,a){var n=this,o=this;console.log("[xianning_ctrl], gateway_sn",this.gateway_sn),console.log("[xianning_ctrl], devunit_name",this.devunit_name),console.log("[xianning_ctrl], devunit_id",this.devunit_id),console.log("[xianning_ctrl], var_id",t),console.log("[xianning_ctrl], var_name",e),console.log("[xianning_ctrl], value",a),o.loading=!0,i.post({url:"cmd/exec/remote/set",data:{gw_sn:this.gateway_sn,devunit_name:this.devunit_name,dev_id:this.devunit_id,var_id:t,var_name:e,var_value:a},success:function(t,a){console.log("[xianning_ctrl] remote set...",t),0==t.ret_code&&(n.loading=!1,console.log("[xianning_ctrl] set ok",t),"远程启动"==e&&(n.button_stop_disable=!1,n.button_start_disable=!0,n.run_status_string="运行",n.topo_src=n.topo_src_start),"远程停止"==e&&(n.button_stop_disable=!0,n.button_start_disable=!1,n.run_status_string="停止",n.topo_src=n.topo_src_stop)),0!=t.ret_code&&(n.loading=!1,uni.showToast({duration:1500,icon:"none",title:t.ret_msg}))}})},devstart:function(t){var e=this.real_data_list["data"];if(e.length<=0)uni.showToast({duration:1500,icon:"none",title:"组态数据错误"});else{for(var a=65535,i="",n=0;n<e.length;n++)if("远程启动"==e[n].varName){a=e[n].varId,i=e[n].varName;break}this.remote_wirte_value(a,i,"1")}},devstop:function(t){var e=this.real_data_list["data"];if(e.length<=0)uni.showToast({duration:1500,icon:"none",title:"组态数据错误"});else{for(var a=65535,i="",n=0;n<e.length;n++)if("远程停止"==e[n].varName){a=e[n].varId,i=e[n].varName;break}this.remote_wirte_value(a,i,"1")}}}};e.default=n},aa87:function(t,e,a){"use strict";a.r(e);var i=a("5ef2"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},c78e:function(t,e,a){"use strict";var i="web",n=(getApp(),"http://yun.jdwanxiang.com");t.exports={HOST:n,API_ROOT:n+"/api/",DeviceType:i,post:function(t){t.method="POST",this.request(t)},delete:function(t){t.method="DELETE",this.request(t)},get:function(t){t.method="GET",this.request(t)},put:function(t){t.method="PUT",this.request(t)},request:function(t){var e=this.API_ROOT,a="";try{a=uni.getStorageSync("token")}catch(o){}var n="";try{n=uni.getStorageSync("cookie")}catch(o){}console.log("[api][request] url:",t.url),console.log("[api][request] method:",t.method),console.log("[api][request] options.data:",t.data),console.log("[api][request] cookie:",n),uni.request({url:e+t.url,data:t.data,method:t.method?t.method:"POST",header:{"Content-Type":"application/json","XX-Token":a,"XX-Device-Type":i,Cookie:n},success:function(e){var a=e.data;2001==a.ret_code?uni.showModal({title:"提示",content:"登录已过期，请重新登录",success:function(t){t.confirm&&uni.navigateTo({url:"../login/login"})}}):t.success(a,e.header)},fail:function(e){t.fail&&t.fail(e)},complete:t.complete?t.complete:null})},uploadFile:function(t){t.url=this.API_ROOT+t.url;var e=this.getToken(),a=this,n=t.success;t.success=function(t){var e=JSON.parse(t.data);0==e.code&&e.data&&e.data.code&&10001==e.data.code?a.login():n(e)},t.header={"XX-Token":e,"XX-Device-Type":i},uni.uploadFile(t)},getToken:function(){var t="";try{t=uni.getStorageSync("token")}catch(e){}return t}}},dc87:function(t,e,a){"use strict";a.r(e);var i=a("1cae"),n=a("aa87");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("1e42");var s,r=a("f0c5"),l=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"3dedaca1",null,!1,i["a"],s);e["default"]=l.exports}}]);